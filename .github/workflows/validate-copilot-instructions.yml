name: Validate Copilot Instructions

on:
  push:
    branches:
      - main
      - '**'
    paths:
      - '.github/copilot-instructions.md'
      - 'scripts/validate-copilot-instructions.js'
      - '.github/workflows/validate-copilot-instructions.yml'
  pull_request:
    branches:
      - main
    paths:
      - '.github/copilot-instructions.md'
      - 'scripts/validate-copilot-instructions.js'
      - '.github/workflows/validate-copilot-instructions.yml'

jobs:
  validate:
    name: Validate Copilot Instructions Structure
    runs-on: ubuntu-latest
    
    steps:
      - name: Checkout code
        uses: actions/checkout@v4
      
      - name: Setup Node.js
        uses: actions/setup-node@v4
        with:
          node-version: '18'
      
      - name: Run validation script
        run: npm run test:copilot-instructions
      
      - name: Report success
        if: success()
        run: |
          echo "✅ Copilot instructions validation passed!"
          echo "The .github/copilot-instructions.md file has correct structure."
      
      - name: Report failure
        if: failure()
        run: |
          echo "❌ Copilot instructions validation failed!"
          echo "Please check the .github/copilot-instructions.md file structure."
          exit 1
